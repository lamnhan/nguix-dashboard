<div class="host">

  <div class="header">
    <div class="left">
      <strong>
        <i
          class="icon-medium-tint"
          [class]="type==='record'?'icon-dashboard-record':'icon-dashboard-array'"
        ></i>
        <span>{{ type==='record' ? 'Record' : 'Array' }}</span>
      </strong>
      <a
        *ngIf="mode!=='edit'"
        href="javascript:void(0)"
        (click)="mode=mode==='table'?'raw':'table'"
      >{{ mode === 'table' ? 'Raw' : 'Table' }}</a>
    </div>
    <div class="right">
      <a *ngIf="mode!=='edit'" href="javascript:void(0)" (click)="mode='edit'">Edit</a>
      <a *ngIf="mode==='edit'" href="javascript:void(0)" (click)="mode='table'">Exit</a>
    </div>
  </div>

  <ng-container *ngIf="mode==='edit'; else viewMode">

    <div class="edit container">

      <table class="table-bordered">
        <thead>
          <tr>
            <th></th>
            <th
              *ngFor="let schemaItem of schema"
              [class.required]="schemaItem.required"
              [style]="{'min-width': (schemaItem.width || 70) + 'px'}"
            >{{ schemaItem.name }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let matrixItem of dataMatrix; let i = index">
            <td><a href="javascript:void(0)" (click)="remove(i)">Remove</a></td>
            <td *ngFor="let schemaItem of matrixItem">

              <ng-container *ngIf="schemaItem.type === 'string'">
                <input class="form-control" type="text" [(ngModel)]="schemaItem.value">
              </ng-container>

              <ng-container *ngIf="schemaItem.type === 'number'">
                <input class="form-control" [type]="schemaItem.type" [(ngModel)]="schemaItem.value">
              </ng-container>

              <ng-container *ngIf="schemaItem.type === 'boolean'">
                <input class="form-checkbox" type="checkbox" [(ngModel)]="schemaItem.value">
              </ng-container>

            </td>
          </tr>
          <tr>
            <td colspan="42">
              <a href="javascript:void(0)" (click)="add()">Add</a>
            </td>
          </tr>
        </tbody>
      </table>

    </div>

    <div class="actions">
      <a class="button-outline-dark-sm" href="javascript:void(0)" (click)="mode='table'">Cancel</a>
      <a class="button-primary-sm" href="javascript:void(0)" (click)="submit()">Save</a>
    </div>

  </ng-container>

  <ng-template #viewMode>

    <div class="view-none" *ngIf="!currentData; else hasData">
      No data ...
    </div>

    <ng-template #hasData>

      <div class="view-table container">

        <table class="table-bordered" *ngIf="mode==='table'">
          <thead>
            <tr>
              <th
                *ngFor="let schemaItem of schema"
                [class.required]="schemaItem.required"
                [style]="{'min-width': (schemaItem.width || 70) + 'px'}"
              >{{ schemaItem.name }}</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let matrixItem of dataMatrix">
              <td *ngFor="let schemaItem of matrixItem">{{ schemaItem.value }}</td>
            </tr>
          </tbody>
        </table>

      </div>
    
      <div class="view-raw" *ngIf="mode==='raw'">
        <pre><code>{{ dataRaw }}</code></pre>
      </div>

    </ng-template>

  </ng-template>

</div>