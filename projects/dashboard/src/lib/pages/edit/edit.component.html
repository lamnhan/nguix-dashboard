<div class="host dashboard page"  *ngIf="data$ | async as data; else loading">

  <div class="main" *ngIf="data.part as part; else notFound">

    <div class="head">

      <div class="title">
        <h1>Add New Post</h1>
      </div>

    </div>

    <div class="body">
      <form
        [formGroup]="data.formGroup"
        (ngSubmit)="submit(part, data.formGroup)"
        #theForm="ngForm"
      >

        <div class="group" *ngFor="let schema of data.formSchema">
          <label class="form-label" [for]="schema.name">{{ schema.label }}</label>

          <ng-container
            *ngIf="
              schema.type==='input' ||
              schema.type==='number'
            "
          >
            <input
              class="form-control"
              [id]="schema.name"
              [type]="schema.type"
              [formControlName]="schema.name"
              [placeholder]="schema.placeholder || ''"
            >
          </ng-container>

          <ng-container *ngIf="schema.type==='textarea'">
            <textarea
              class="form-control"
              [id]="schema.name"
              [formControlName]="schema.name"
              [placeholder]="schema.placeholder || ''"
            ></textarea>
          </ng-container>

          <ng-container *ngIf="schema.type==='checkbox'">
            <label *ngFor="let checkboxItem of schema.children || []">
              <input
                type="checkbox"
                (change)="checkboxChanges(
                  schema.name,
                  data.formGroup,
                  schema.children,
                  checkboxItem,
                  $event
                )"
              >
              <span>{{ checkboxItem.text }}</span>
            </label>
          </ng-container>

          <ng-container *ngIf="schema.type==='status'">
            <select [id]="schema.name" [formControlName]="schema.name">
              <option value="publish">Publish</option>
              <option value="draft">Draft</option>
              <option value="archive">Archive</option>
            </select>
          </ng-container>

          <ng-container *ngIf="schema.type==='locale'">
            <select [id]="schema.name" [formControlName]="schema.name">
              <option
                *ngFor="let localeItem of settingService.locales"
                [value]="localeItem.value"
              >{{ localeItem.text }}</option>
            </select>
          </ng-container>

        </div>

        <div class="actions">
          <button
            class="button-primary"
            type="submit"
            [disabled]="!theForm.form.valid"
          >{{ submitText }}</button>
        </div>

      </form>
    </div>

  </div>
  
  <ng-template #notFound>
    <div class="not-found">Not found ...</div>
  </ng-template>
</div>

<ng-template #loading>
  <div class="loading">Loading ...</div>
</ng-template>
