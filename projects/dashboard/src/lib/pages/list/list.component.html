<div class="host dashboard page" *ngIf="data$ | async as data; else loading">

  <div class="main" *ngIf="data.part as part; else notFound">
  <ng-container *ngIf="data.items | queryFilter : query; let filteredItems">

    <div class="head">

      <div class="title">
        <h1>Posts</h1>
        <a
          class="button-outline-primary"
          [usefulRouterLink]="['admin', 'new', part.name]"
        >Add New</a>
      </div>

      <ul class="statuses" *ngIf="filteredItems | extractStatuses as listingStatuses">
        <ng-container *ngFor="let listingStatus of listingStatuses">
          <li *ngIf="listingStatus.count">
            <strong *ngIf="listingStatus.value === status; else inactive">{{ listingStatus.title }}</strong>
            <ng-template #inactive>
              <a href="#" (click)="status=listingStatus.value; false">{{ listingStatus.title }}</a>
            </ng-template>
            <em>({{ listingStatus.count }})</em>
          </li>
        </ng-container>
      </ul>

    </div>
    
    <div class="body">

      <ng-template #listingBar>
        <div class="filter">    
          <input
            class="form-control"
            type="search"
            placeholder="Filter items ..."
            [(ngModel)]="query"
          >    
        </div>
        <div class="counter">3 items</div>
      </ng-template>

      <div class="headbar">
        <ng-container *ngTemplateOutlet="listingBar"></ng-container>
      </div>

      <table class="listing table-striped">  
        <thead>
          <tr>
            <th class="title">Title</th>
            <th class="author">Author</th>
            <!-- <th class="comment"><i class="icon-dark icon-dashboard-comment"></i></th> -->
            <th class="date">Date</th>
          </tr>
        </thead>  
        <tbody>
          <tr *ngFor="let listingItem of filteredItems | statusFilter : status | paginate: {itemsPerPage: 30, currentPage: p}">
          <ng-container *ngIf="listingItem.all as items">
  
            <td class="title">  
              <ul>
                <li *ngFor="let item of items">

                  <div class="major">
                    <em>{{ data.recordLocales[item.locale].text }}</em>
                    <a [usefulRouterLink]="['admin', 'edit', part.name, item.id]">{{ item.title }}</a>
                  </div>  
  
                  <ul class="actions">
                    <li class="edit"><a href="#">Edit</a></li>
                    <li class="trash"><a href="#">Trash</a></li>
                    <li class="preview"><a href="#">Preview</a></li>
                    <li class="detail"><a href="#" (click)="detail=detail&&detail===item.id?'':item.id; false">Detail</a></li>
                  </ul>  
  
                  <ul class="mobile-detail" [class.show]="item.id===detail">
                    <li><span>Author</span><a href="#">Lam Nhan</a></li>
                    <!-- <li><span>Comment</span><em>-</em></li> -->
                    <li><span>Date</span><em>Published — 2018/10/02 at 1:04 pm</em></li>
                  </ul>

                </li>

                <ng-container *ngFor="let missingTranslation of listingItem.missingTranslations">
                <li>
                  <em>{{ data.recordLocales[missingTranslation].text }}</em>
                  <a href="#">Add Translation</a>
                </li>
                </ng-container>

              </ul>
            </td>

            <td class="author">  
              <ul>
                <li *ngFor="let item of items">
                  <a href="#">Lam Nhan</a>
                </li>
              </ul>  
            </td>

            <!-- <td class="comment">              
              <ul>
                <li *ngFor="let item of items">
                  —
                </li>
              </ul>  
            </td> -->

            <td class="date">
              <ul>
                <li *ngFor="let item of items">
                  <strong>Published</strong><span>—</span><em>2018/10/02 at 1:04 pm</em>
                </li>
              </ul>  
            </td>
  
          </ng-container>
          </tr>
        </tbody>  
        <tfoot>
          <tr>
            <td colspan="42">
              <pagination-controls
                (pageChange)="p=$event"
                [directionLinks]="false"
              ></pagination-controls>
            </td>
          </tr>
        </tfoot>  
      </table>

      <div class="footbar">
        <ng-container *ngTemplateOutlet="listingBar"></ng-container>
      </div>

    </div>

  </ng-container>
  </div>

  <ng-template #notFound>
    <div class="not-found">Not found ...</div>
  </ng-template>

</div>

<ng-template #loading>
  <div class="loading">Loading ...</div>
</ng-template>
